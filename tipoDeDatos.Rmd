
<center><img src="https://github.com/PsicologiaPUCP/codigos/raw/master/pics/LOGO_PUCP.png" width="500"></center>

<center> <header><h1>PSICOLOGIA: Investigación y Estadística II</h1>  </header></center>

* Profesor:  <a href="http://www.pucp.edu.pe/profesor/jose-manuel-magallanes/" target="_blank">Dr. José Manuel Magallanes, Ph.D.</a> <br>
    - Profesor del Departamento de Ciencias Sociales, Sección de Ciencia Política y Gobierno. Profesor Afiliado del Departamento de Psicología.
    - [Oficina 105](https://goo.gl/maps/xuGeG6o9di1i1y5m6) - Edificio CISEPA / ECONOMIA / CCSS
    - Telefono: (51) 1 - 6262000 anexo 4302
    - Correo Electrónico: [jmagallanes@pucp.edu.pe](mailto:jmagallanes@pucp.edu.pe)
    

____

<center> <header><h2>Cambiando atributos de las variables</h2>  </header></center>
____

### 1. Carga de archivos

Los archivos deben estar siempre en la nube, si es en SPSS se puede usar GitHub para almacenarlos, si es en CSV, en GoogleSheets. En particular, usaras SPSS si alguien comparte ese tipo de archivo contigo; pro si recoges tu propia información, será mejor que te familiarices con CSV en Google.

* Caso CSV, desde Google: 

El link que necesitas lo creas **publicando** tu hoja de datos en formato CSV. Este es un link de ejemplo:
```{r}
# link a data:
linkCSV="https://docs.google.com/spreadsheets/d/e/2PACX-1vTcFY_f_k94wuMUL8ISrklSmjlbYgnPeEVdGApFI0Y39OQB8IrHvv1bmD6E0u9uYo06Bpl5llns-BLR/pub?gid=1282421390&single=true&output=csv"

# recuperar data:
hsbCSV=read.csv(linkCSV,stringsAsFactors = F)

# ver lo que se recuperó:
head(hsbCSV)
```


* Caso SPSS, desde GitHub:

Si alguien te comparte un archivo de SPSS, este archivo subelo  GitHub. Luego, copia el enlace de descarga:

```{r, message=FALSE}
# link a data:
linkSPSS="https://github.com/PsicologiaPUCP/ArchivosDeDatos/raw/master/hsb.sav"

# recuperar data:
library(foreign) 
hsbSPSS=read.spss(linkSPSS,to.data.frame = T)

# ver lo que se recuperó:
head(hsbSPSS)
```

### 2. Identificar atributos

Toda variable tiene:

* Nombre
* Descripción
* Escala
    - Texto
    - Categórica
        - Nominal
        - Ordinal
    - Numérica

Si la variable es *Categórica*, tiene **niveles**.

Esta información debe buscarse en el diccionario de datos o las guías metodológicas de la data. Para el caso de la data que acabamos de abrir, el documento está [aquí](https://github.com/PsicologiaPUCP/ArchivosDeDatos/raw/master/metadata/hsb.pdf). Las variables deben tener esta información; y eso es lo que haremos a continuación.


### 3. Reajustar tipo de datos

El ajuste lo podemos hacer a cualquiera de los archivos. Hagámoslo al CSV, pues es el que necesitas para tu trabajo final. Primero veamos qué ha identificado este archivo por _default_:

```{r}
str(hsbCSV)
```

Toda tabla de datos debe tener un campo único (clave o _key_). Ese campo debe ser tipo texto. El campo clave de esta tabla de *ID*, pero se ha leído como número entero. Podemos cambiarlo así:

```{r}
hsbCSV$ID=as.character(hsbCSV$ID)
```

Siguiendo las especificaciones de la metadata, vemos que R ha identificado bien todas las numéricas, desde LOCUS a CIV, descartando a CAR. R y SPSS identifican siempre los valores con decimales como números, salvo que algún valor está mal escrito en esa columna (sea un texto):

<img src="https://github.com/PsicologiaPUCP/codigos/raw/master/pics/spss_default.png" width="500">

De aquí sabemos que el mayor trabajo está en las categóricas.  Si estás en SPSS debes ir al menú _Datos_ y de ahí elegir _Definir Propiedades de Variables_:

<img src="https://github.com/PsicologiaPUCP/codigos/raw/master/pics/spss_VarProperties.png" width="500">


R denomina llama a las categóricas _factor_. El código para convertir estás variables en factor, depende si estas son Nominales u Ordinales. Ajustemos la única ordinal que hay, nivel socio económico. Sigue estos pasos:

* Explorar:
```{r}
table(hsbCSV$SES)
```

* Ajustar:
```{r}
hsbCSV$SES=factor(hsbCSV$SES,     #variable
                  levels=c(1,2,3),#orden 
                  labels = c("Low","Medium","High"), #sigue orden de 'levels'
                  ordered = TRUE) # para ordinal

# verificando:
table(hsbCSV$SES)
```

```{r}
table(hsbCSV$RACE)
```

Las nominales se convierten así:
```{r}
# labels
varsLabels=list(SEX=c('Male','Female'), 
                RACE=c('Hispanic','Asian','Black','White'),
                SCTYP=c('Public','Private'),
                HSP=c('General','Academic preparatory','Vocational/technical'),
                CAR=c('Clerical','Craftsman','Farmer','Homemaker','Laborer','Manager',
                  'Military','Operative','Professional 1','Professional 2','Proprietor',
                  'Protective','Sales','School','Service','Technical','Not working'))

# cambios
hsbCSV$SEX=factor(hsbCSV$SEX,
                  levels = 1:length(varsLabels$SEX),
                  labels=varsLabels$SEX)

hsbCSV$RACE=factor(hsbCSV$RACE,
                  levels = 1:length(varsLabels$RACE),
                  labels=varsLabels$RACE)

hsbCSV$SCTYP=factor(hsbCSV$SCTYP,
                  levels = 1:length(varsLabels$SCTYP),
                  labels=varsLabels$SCTYP)

hsbCSV$HSP=factor(hsbCSV$HSP,
                  levels = 1:length(varsLabels$HSP),
                  labels=varsLabels$HSP)

hsbCSV$CAR=factor(hsbCSV$CAR,
                  levels = 1:length(varsLabels$CAR),
                  labels=varsLabels$CAR)
```

Verificando:
```{r}
str(hsbCSV)
```


Si haces lo correcto en [SPSS](https://github.com/PsicologiaPUCP/ArchivosDeDatos/raw/master/hsb_atributos.sps), habrías obtenido esto:

<img src="https://github.com/PsicologiaPUCP/codigos/raw/master/pics/spss_ajustado.png" width="500">


### 4. Pedir Descriptivos

Cuando tengas ya los datos ajustados, puedes ya solicitar los estadísticos descriptivos:
```{r}
summary(hsbCSV)
```

Nótese que R, cuando ya sabe el tipo de variable, informar lo que corresponde, sin embargo, si a SPSS le pides [descriptivos](https://github.com/PsicologiaPUCP/ArchivosDeDatos/raw/master/hsb_descriptivos.sps) obtienes esto:

<img src="https://github.com/PsicologiaPUCP/codigos/raw/master/pics/spss_descriptivos.png" width="500">

¿Qué diferencias encuentras?







